<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaChat - Fixed Implementation</title>
    <style>
        :root {
            --primary-color: #128C7E;
            --secondary-color: #25D366;
            --background-color: #f0f0f0;
            --surface-color: #ffffff;
            --text-color: #333333;
            --text-secondary: #667781;
            --border-color: #e0e0e0;
            --message-sent: #DCF8C6;
            --message-received: #ffffff;
            --online-status: #34B7F1;
            --typing-indicator: #8696a0;
        }

        [data-theme="dark"] {
            --background-color: #0d1418;
            --surface-color: #2a2f32;
            --text-color: #e6e6e6;
            --text-secondary: #a6a6a6;
            --border-color: #3d3d3d;
            --message-sent: #056162;
            --message-received: #262d31;
            --typing-indicator: #e6e6e6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
        }

        .screen {
            display: none;
            height: 100vh;
            width: 100vw;
        }

        .screen.active {
            display: block;
        }

        /* Auth Screen */
        #auth-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, var(--primary-color), #075E54);
        }

        .auth-container {
            background-color: var(--surface-color);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 400px;
        }

        .auth-container h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .tab-btn {
            flex: 1;
            padding: 0.75rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-form input {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
        }

        .auth-form button {
            width: 100%;
            padding: 0.75rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .auth-form button:hover {
            background-color: #0C7B6F;
        }

        .error-message {
            color: #ff3860;
            margin-top: 1rem;
            text-align: center;
        }

        /* Chat Screen */
        .chat-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 30%;
            max-width: 400px;
            background-color: var(--surface-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
        }

        .user-profile {
            display: flex;
            align-items: center;
        }

        .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 0.75rem;
            object-fit: cover;
        }

        .sidebar-actions button {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            margin-left: 0.5rem;
            color: var(--text-secondary);
        }

        .search-container {
            padding: 0.5rem 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .search-container input {
            width: 100%;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 20px;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .contacts-list {
            flex: 1;
            overflow-y: auto;
        }

        .contact-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .contact-item:hover {
            background-color: var(--background-color);
        }

        .contact-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .contact-item img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 1rem;
            object-fit: cover;
        }

        .contact-info {
            flex: 1;
        }

        .contact-name {
            display: block;
            font-weight: 500;
        }

        .contact-status {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .contact-item.active .contact-status {
            color: rgba(255, 255, 255, 0.8);
        }

        .ai-contact {
            background-color: rgba(18, 140, 126, 0.1);
            border-left: 4px solid var(--primary-color);
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--background-color);
        }

        .chat-header {
            padding: 1rem;
            background-color: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-info {
            display: flex;
            align-items: center;
        }

        .chat-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 0.75rem;
            object-fit: cover;
        }

        .chat-actions button {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            margin-left: 0.5rem;
            color: var(--text-secondary);
        }

        .messages-container {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .message {
            max-width: 70%;
            padding: 0.5rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 10px;
            position: relative;
            word-wrap: break-word;
        }

        .message.sent {
            align-self: flex-end;
            background-color: var(--message-sent);
        }

        .message.received {
            align-self: flex-start;
            background-color: var(--message-received);
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }

        .message-content {
            margin-bottom: 0.25rem;
        }

        .message-time {
            font-size: 0.7rem;
            text-align: right;
            color: var(--text-secondary);
        }

        .message-edited {
            font-style: italic;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .message-actions {
            position: absolute;
            top: 0;
            right: -30px;
            display: none;
        }

        .message:hover .message-actions {
            display: flex;
        }

        .message-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .typing-indicator {
            padding: 0.5rem 1rem;
            font-style: italic;
            color: var(--typing-indicator);
            font-size: 0.9rem;
            min-height: 1.5rem;
        }

        .message-input-container {
            padding: 1rem;
            background-color: var(--surface-color);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }

        .message-input-container button {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.5rem;
        }

        #message-input {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 20px;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0 0.5rem;
        }

        /* Settings Screen */
        .settings-container {
            height: 100vh;
            background-color: var(--surface-color);
            max-width: 600px;
            margin: 0 auto;
        }

        .settings-header {
            padding: 1rem;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .settings-header button {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            margin-right: 1rem;
            color: var(--text-color);
        }

        .settings-content {
            padding: 1rem;
            overflow-y: auto;
            height: calc(100vh - 60px);
        }

        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .profile-settings {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .avatar-upload {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto;
        }

        .avatar-upload img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .avatar-upload label {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .avatar-upload input[type="file"] {
            display: none;
        }

        .profile-settings input {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .privacy-settings label,
        .theme-settings label,
        .ai-settings {
            display: block;
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 5px;
            background-color: var(--background-color);
        }

        .privacy-settings select,
        .ai-settings select,
        .ai-settings input {
            float: right;
            padding: 0.25rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--surface-color);
            color: var(--text-color);
        }

        .ai-settings input {
            width: 150px;
            padding: 0.5rem;
        }

        button {
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        #save-profile {
            background-color: var(--primary-color);
            color: white;
            width: 100%;
        }

        #save-profile:hover {
            background-color: #0C7B6F;
        }

        #admin-btn {
            background-color: #ff3860;
            color: white;
            width: 100%;
            margin-bottom: 1rem;
        }

        #admin-btn:hover {
            background-color: #e62c52;
        }

        #logout-btn {
            background-color: var(--text-secondary);
            color: white;
            width: 100%;
        }

        #logout-btn:hover {
            background-color: #5a6268;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chat-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                max-width: none;
                height: 40vh;
            }
            
            .chat-area {
                height: 60vh;
            }
            
            .settings-container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Auth Screen -->
        <div id="auth-screen" class="screen active">
            <div class="auth-container">
                <h1>NovaChat</h1>
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">Login</button>
                    <button class="tab-btn" data-tab="register">Register</button>
                </div>
                
                <form id="login-form" class="auth-form active">
                    <input type="email" id="login-email" placeholder="Email" required>
                    <input type="password" id="login-password" placeholder="Password" required>
                    <button type="submit">Login</button>
                </form>
                
                <form id="register-form" class="auth-form">
                    <input type="text" id="register-name" placeholder="Display Name" required>
                    <input type="email" id="register-email" placeholder="Email" required>
                    <input type="password" id="register-password" placeholder="Password" required>
                    <button type="submit">Register</button>
                </form>
                
                <div id="auth-error" class="error-message"></div>
            </div>
        </div>
        
        <!-- Main Chat Screen -->
        <div id="chat-screen" class="screen">
            <div class="chat-container">
                <!-- Sidebar -->
                <div class="sidebar">
                    <div class="sidebar-header">
                        <div class="user-profile">
                            <img id="user-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+QTwvdGV4dD48L3N2Zz4=" alt="Profile">
                            <span id="user-name">User</span>
                        </div>
                        <div class="sidebar-actions">
                            <button id="new-chat-btn" title="New Chat">+</button>
                            <button id="settings-btn" title="Settings">‚öôÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="search-container">
                        <input type="text" id="search-contacts" placeholder="Search contacts...">
                    </div>
                    
                    <div class="contacts-list">
                        <div class="ai-contact contact-item" data-id="ai">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzEyOEM3RSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iI2ZmZmZmZiI+Qkk8L3RleHQ+PC9zdmc+" alt="Bera AI">
                            <div class="contact-info">
                                <span class="contact-name">Bera AI</span>
                                <span class="contact-status">AI Assistant</span>
                            </div>
                        </div>
                        <div id="contacts-container">
                            <!-- Contacts will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Chat Area -->
                <div class="chat-area">
                    <div class="chat-header">
                        <div id="current-chat-info" class="chat-info">
                            <img id="chat-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+QjwvdGV4dD48L3N2Zz4=" alt="Contact">
                            <div>
                                <span id="chat-name">Select a contact</span>
                                <span id="chat-status"></span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button id="video-call-btn" title="Video Call">üìπ</button>
                            <button id="voice-call-btn" title="Voice Call">üìû</button>
                            <button id="chat-info-btn" title="Chat Info">‚ÑπÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="messages-container">
                        <div id="messages-list">
                            <!-- Messages will appear here -->
                            <div class="message received">
                                <div class="message-content">Welcome to NovaChat! Select a contact to start chatting.</div>
                                <div class="message-time">12:00 PM</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="typing-indicator" id="typing-indicator"></div>
                    
                    <div class="message-input-container">
                        <button id="attach-btn">üìé</button>
                        <input type="text" id="message-input" placeholder="Type a message...">
                        <button id="send-btn">‚û§</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Settings Screen -->
        <div id="settings-screen" class="screen">
            <div class="settings-container">
                <div class="settings-header">
                    <button id="back-to-chat">‚Üê</button>
                    <h2>Settings</h2>
                </div>
                
                <div class="settings-content">
                    <div class="settings-section">
                        <h3>Profile</h3>
                        <div class="profile-settings">
                            <div class="avatar-upload">
                                <img id="settings-avatar" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+QTwvdGV4dD48L3N2Zz4=" alt="Profile">
                                <input type="file" id="avatar-input" accept="image/*">
                                <label for="avatar-input">Change</label>
                            </div>
                            <input type="text" id="profile-name" placeholder="Display Name" value="User">
                            <input type="text" id="profile-status" placeholder="Status" value="Hey there! I am using NovaChat">
                        </div>
                        <button id="save-profile">Save Profile</button>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Privacy</h3>
                        <div class="privacy-settings">
                            <label>
                                Last Seen
                                <select id="last-seen-setting">
                                    <option value="everyone">Everyone</option>
                                    <option value="contacts">My Contacts</option>
                                    <option value="nobody">Nobody</option>
                                </select>
                            </label>
                            <label>
                                <input type="checkbox" id="read-receipts-setting" checked>
                                Read Receipts
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Theme</h3>
                        <div class="theme-settings">
                            <label>
                                <input type="radio" name="theme" value="light" checked>
                                Light Mode
                            </label>
                            <label>
                                <input type="radio" name="theme" value="dark">
                                Dark Mode
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Bera AI Settings</h3>
                        <div class="ai-settings">
                            <input type="text" id="ai-name" placeholder="AI Name" value="Bera AI">
                            <select id="ai-personality">
                                <option value="friendly">Friendly</option>
                                <option value="professional">Professional</option>
                                <option value="funny">Funny</option>
                                <option value="mentor">Mentor</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <button id="admin-btn">Admin Dashboard</button>
                        <button id="logout-btn">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Fixed NovaChat implementation
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const authScreen = document.getElementById('auth-screen');
            const chatScreen = document.getElementById('chat-screen');
            const settingsScreen = document.getElementById('settings-screen');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const authError = document.getElementById('auth-error');
            const settingsBtn = document.getElementById('settings-btn');
            const backToChatBtn = document.getElementById('back-to-chat');
            const logoutBtn = document.getElementById('logout-btn');
            const saveProfileBtn = document.getElementById('save-profile');
            const messageInput = document.getElementById('message-input');
            const sendBtn = document.getElementById('send-btn');
            const messagesList = document.getElementById('messages-list');
            const contactsContainer = document.getElementById('contacts-container');
            const aiContact = document.querySelector('.ai-contact');
            
            // Demo data
            const demoContacts = [
                { id: '2', name: 'John Doe', status: 'Online', avatar: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+SjwvdGV4dD48L3N2Zz4=' },
                { id: '3', name: 'Jane Smith', status: 'Last seen 5 min ago', avatar: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC2hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+SiQ8L3RleHQ+PC9zdmc+' },
                { id: '4', name: 'Alex Johnson', status: 'Last seen 1 hour ago', avatar: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+QTwvdGV4dD48L3N2Zz4=' }
            ];
            
            // Current user and chat state
            let currentUser = null;
            let currentChat = null;
            
            // Auth tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const tab = btn.dataset.tab;
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(`${tab}-form`).classList.add('active');
                });
            });
            
            // Login handler
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                
                // Simple validation
                if (!email || !password) {
                    authError.textContent = 'Please fill in all fields';
                    return;
                }
                
                // Simulate login
                authError.textContent = '';
                currentUser = {
                    id: '1',
                    email: email,
                    displayName: 'Demo User',
                    profilePicture: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+RDwvdGV4dD48L3N2Zz4='
                };
                
                showChatScreen();
                loadContacts();
            });
            
            // Register handler
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                
                // Simple validation
                if (!name || !email || !password) {
                    authError.textContent = 'Please fill in all fields';
                    return;
                }
                
                if (password.length < 6) {
                    authError.textContent = 'Password must be at least 6 characters';
                    return;
                }
                
                // Simulate registration
                authError.textContent = '';
                currentUser = {
                    id: '1',
                    email: email,
                    displayName: name,
                    profilePicture: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RkZGRkZCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iIzk5OTk5OSI+UjwvdGV4dD48L3N2Zz4='
                };
                
                showChatScreen();
                loadContacts();
            });
            
            // Navigation handlers
            settingsBtn.addEventListener('click', showSettingsScreen);
            backToChatBtn.addEventListener('click', showChatScreen);
            logoutBtn.addEventListener('click', logout);
            
            // Save profile handler
            saveProfileBtn.addEventListener('click', function() {
                const newName = document.getElementById('profile-name').value;
                const newStatus = document.getElementById('profile-status').value;
                
                if (newName) {
                    document.getElementById('user-name').textContent = newName;
                    currentUser.displayName = newName;
                }
                
                alert('Profile saved successfully!');
                showChatScreen();
            });
            
            // Message sending handler
            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Contact selection
            aiContact.addEventListener('click', function() {
                selectChat('ai', 'Bera AI', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzEyOEM3RSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSI0MCIgZmlsbD0iI2ZmZmZmZiI+Qkk8L3RleHQ+PC9zdmc+', 'AI Assistant');
            });
            
            // Show chat screen
            function showChatScreen() {
                authScreen.classList.remove('active');
                settingsScreen.classList.remove('active');
                chatScreen.classList.add('active');
                
                // Update user info
                if (currentUser) {
                    document.getElementById('user-name').textContent = currentUser.displayName;
                    document.getElementById('user-avatar').src = currentUser.profilePicture;
                }
            }
            
            // Show settings screen
            function showSettingsScreen() {
                authScreen.classList.remove('active');
                chatScreen.classList.remove('active');
                settingsScreen.classList.add('active');
            }
            
            // Load contacts
            function loadContacts() {
                contactsContainer.innerHTML = '';
                
                demoContacts.forEach(contact => {
                    const contactElement = document.createElement('div');
                    contactElement.className = 'contact-item';
                    contactElement.dataset.id = contact.id;
                    
                    contactElement.innerHTML = `
                        <img src="${contact.avatar}" alt="${contact.name}">
                        <div class="contact-info">
                            <span class="contact-name">${contact.name}</span>
                            <span class="contact-status">${contact.status}</span>
                        </div>
                    `;
                    
                    contactElement.addEventListener('click', function() {
                        selectChat(contact.id, contact.name, contact.avatar, contact.status);
                    });
                    
                    contactsContainer.appendChild(contactElement);
                });
            }
            
            // Select chat
            function selectChat(id, name, avatar, status) {
                currentChat = id;
                
                // Update UI
                document.querySelectorAll('.contact-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                document.querySelector(`.contact-item[data-id="${id}"]`).classList.add('active');
                document.getElementById('chat-name').textContent = name;
                document.getElementById('chat-avatar').src = avatar;
                document.getElementById('chat-status').textContent = status;
                
                // Load messages
                loadMessages(id);
            }
            
            // Load messages
            function loadMessages(chatId) {
                // Clear current messages
                messagesList.innerHTML = '';
                
                // Add welcome message for AI
                if (chatId === 'ai') {
                    addMessage('ai', 'Hello! I am Bera AI, your personal assistant. How can I help you today?', true);
                } else {
                    // Demo messages for regular contacts
                    addMessage(chatId, `Hi there! This is a conversation with ${document.getElementById('chat-name').textContent}.`, true);
                    addMessage('self', "Hello! I'm interested in trying out NovaChat.", false);
                    
                    if (chatId === '2') {
                        addMessage(chatId, "Great! NovaChat is awesome. You'll love the real-time messaging and AI features.", true);
                    } else if (chatId === '3') {
                        addMessage(chatId, "Hey! How's it going? I heard you're testing NovaChat.", true);
                    } else if (chatId === '4') {
                        addMessage(chatId, "Hi! I'm excited to chat with you on NovaChat. The UI looks really nice!", true);
                    }
                }
                
                // Scroll to bottom
                messagesList.scrollTop = messagesList.scrollHeight;
            }
            
            // Add message to UI
            function addMessage(sender, content, isReceived) {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${isReceived ? 'received' : 'sent'}`;
                
                const now = new Date();
                const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                messageElement.innerHTML = `
                    <div class="message-content">${content}</div>
                    <div class="message-time">${time}</div>
                `;
                
                messagesList.appendChild(messageElement);
                
                // Scroll to bottom
                messagesList.scrollTop = messagesList.scrollHeight;
            }
            
            // Send message
            function sendMessage() {
                const content = messageInput.value.trim();
                if (!content || !currentChat) return;
                
                // Add message to UI
                addMessage('self', content, false);
                
                // Clear input
                messageInput.value = '';
                
                // Simulate response for AI
                if (currentChat === 'ai') {
                    setTimeout(() => {
                        const responses = [
                            "I understand. Is there anything specific you'd like to know?",
                            "That's interesting! Tell me more about that.",
                            "I can help you with various tasks. Just let me know what you need!",
                            "Thanks for sharing. How can I assist you further?",
                            "I'm here to help. What would you like to talk about?"
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addMessage('ai', randomResponse, true);
                    }, 1000);
                } else {
                    // Simulate response for regular contacts
                    setTimeout(() => {
                        const responses = [
                            "Thanks for your message!",
                            "I got your message. I'll reply properly once the backend is connected.",
                            "This is a demo response. In the full app, you'd get real messages here.",
                            "Nice message! The real app would deliver this to the recipient.",
                            "I appreciate your message. This is just a frontend demo."
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addMessage(currentChat, randomResponse, true);
                    }, 1000);
                }
            }
            
            // Logout
            function logout() {
                currentUser = null;
                currentChat = null;
                
                // Clear forms
                loginForm.reset();
                registerForm.reset();
                
                // Show auth screen
                chatScreen.classList.remove('active');
                settingsScreen.classList.remove('active');
                authScreen.classList.add('active');
                
                // Switch to login tab
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                document.querySelector('[data-tab="login"]').classList.add('active');
                document.getElementById('login-form').classList.add('active');
            }
            
            // Theme toggle
            document.querySelectorAll('input[name="theme"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.documentElement.setAttribute('data-theme', this.value);
                });
            });
            
            // Initialize demo contacts
            loadContacts();
        });
    </script>
</body>
</html>
